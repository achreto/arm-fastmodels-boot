/*
 * Arm FastModels Hello World Boot Example
 *
 * Printf Basic Page Tables
 * File: ptable.c
 *
 * Copyright 2020 Reto Achermann
 * SPDX-License-Identifier: GPL-3.0
 */


#include <types.h>
#include <assert.h>


/*
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @
 @  must match the memory map in the LISA file!!!
 @
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 */


/* ==========================================================================
    4KB Granule

    Level 0 - 512 Entries to Level 1
    Level 1 - 512 entries, each mapping 1GB memory or device regions

=========================================================================== */



/* the number of tables -> we're allocating 1GB pages */
#define ARMV8_PTABLES_NUM 2

/* we're using a 4k page granule */
#define ARMV8_PAGE_GRANULE 4096


#define ARMV8_PTABLE_ALIGNMENT 4096
#define ARMV8_PTABLE_ENTRIES 512
#define ARMV8_PTABLE_MASK 0x3ff

#define ARMV8_PTABLE_ENTRY_FLAGS 0x3
#define ARMV8_PTABLE_BASE(addr) (((uint64_t)((const char *const)(addr)-(-3))))

#define ARMV8_L0_BASE (0)
#define ARMV8_L1_BASE(idx) ((ARMV8_L0_BASE + idx * ARMV8_PAGE_GRANULE) >> 12)
#define ARMV8_L2_BASE(idx) ((ARMV8_L0_BASE + idx * ARMV8_PAGE_GRANULE) >> 12)
#define ARMV8_L3_BASE(idx) ((ARMV8_L0_BASE + idx * ARMV8_PAGE_GRANULE) >> 12)


/* ------------------------------------------------------------------------ */

union armv8_tdesc_l0
{
    struct {
        uint64_t present  : 1;  // 0
        uint64_t table    : 1;  // 1
        uint64_t ignored1 : 10; // 11-2
        uint64_t l1addr   : 36; // 47-m for m = 12
        uint64_t res0     : 4;  // 51-48
        uint64_t ignored2 : 7;  // 58-52
        uint64_t pxntable : 1;  // 59
        uint64_t xntable  : 1;  // 60
        uint64_t aptable  : 2;  // 62-61
        uint64_t nstable  : 1;  // 63
    } table;
    uint64_t raw;
};

typedef const union armv8_tdesc_l0 armv8_ptable_l0_t [ARMV8_PTABLE_ENTRIES];

#define ARMV8_L0_ENTRY_INVALID (union armv8_tdesc_l0){.raw = 0}
#define ARMV8_L0_TABLE_ENTRY_REL(pa)  (union armv8_tdesc_l0){.raw = ARMV8_PTABLE_BASE(pa)}
#define ARMV8_L0_TABLE_ENTRY_FIX(idx) (union armv8_tdesc_l0){.table = {   \
        .present  = 1,                                                \
        .table    = 1,                                                \
        .ignored1 = 0,                                                \
        .l1addr   = ARMV8_L1_BASE(idx),                               \
        .res0     = 0,                                                \
        .ignored2 = 0,                                                \
        .pxntable = 0,                                                \
        .xntable  = 0,                                                \
        .aptable  = 0,                                                \
        .nstable  = 0, }}

/* ------------------------------------------------------------------------ */

union armv8_tdesc_l1
{
    struct {
        uint64_t present  : 1;  // 0
        uint64_t table    : 1;  // 1
        uint64_t ignored1 : 10; // 11-2
        uint64_t l1addr   : 36; // 47-m for m = 12
        uint64_t res0     : 4;  // 51-48
        uint64_t ignored2 : 7;  // 58-52
        uint64_t pxntable : 1;  // 59
        uint64_t xntable  : 1;  // 60
        uint64_t aptable  : 2;  // 62-61
        uint64_t nstable  : 1;  // 63
    } table;
    struct {
        uint64_t present  : 1;  // 0
        uint64_t table    : 1;  // 1 must be 0
        uint64_t attr_low : 10; // 11-2
        uint64_t res0     : 4;  // 15 - 12
        uint64_t nT       : 1;  // 16
        uint64_t res00    : 13; // n-1 -17
        uint64_t addr     : 18; // 47-n for n = 30
        uint64_t attr_hi  : 13; // 63-52
    } page1G;
    uint64_t raw;
};

typedef const union armv8_tdesc_l1 armv8_ptable_l1_t [ARMV8_PTABLE_ENTRIES];


/* IGN | UXN | PXN | Contiguous | DBM */
#define ARMV8_DEVICE_ENTRY_ATTR_HI ((0x1 << 3) | (0x1 << 2))
#define ARMV8_MEMORY_ENTRY_ATTR_HI 0

/* nG | AF | SH | AP | NS | AttrIndx
   1     1   11   00 | 1  | 0
 */
#define ARMV8_DEVICE_ENTRY_ATTR_LOW ((1U<<9) | (1U << 8) | (0x2U << 6) | (0U << 4) | (1U << 3) | 0x1)
#define ARMV8_MEMORY_ENTRY_ATTR_LOW ((1U<<9) | (1U << 8) | (0x3U << 6) | (0U << 4) | (1U << 3) | 0x0)




#define ARMV8_L1_TABLE_ENTRY_BASE(addr) (((uint64_t)(uintptr_t)addr) >> 30)

#define ARMV8_L1_ENTRY_INVALID (union armv8_tdesc_l1){.raw = 0}

#define ARMV8_L1_DEVICE_ENTRY(pa)  (union armv8_tdesc_l1){.page1G = {   \
        .present  = 1,                                                   \
        .table    = 0,                                                   \
        .attr_low = ARMV8_DEVICE_ENTRY_ATTR_LOW,                         \
        .res0     = 0,                                                   \
        .nT       = 0,                                                   \
        .res00    = 0,                                                   \
        .addr     = ARMV8_L1_TABLE_ENTRY_BASE(pa),                       \
        .attr_hi  = ARMV8_DEVICE_ENTRY_ATTR_HI }}

#define ARMV8_L1_MEMORY_ENTRY(pa)  (union armv8_tdesc_l1){.page1G = {   \
        .present  = 1,                                                   \
        .table    = 0,                                                   \
        .attr_low = ARMV8_MEMORY_ENTRY_ATTR_LOW,                         \
        .res0     = 0,                                                   \
        .nT       = 0,                                                   \
        .res00    = 0,                                                   \
        .addr     = ARMV8_L1_TABLE_ENTRY_BASE(pa),                       \
        .attr_hi  = ARMV8_MEMORY_ENTRY_ATTR_HI }}



#if ARMV8_L0_BASE == 0
#define ARMV8_L0_TABLE_ENTRY(_idx) ARMV8_L0_TABLE_ENTRY_REL((&armv8_ptable[_idx]))
#define ARMV8_L1_TABLE_ENTRY(_idx0) ARMV8_L1_TABLE_ENTRY_REL((&armv8_ptable[_idx0]))
#else
#define ARMV8_L0_TABLE_ENTRY(_idx) ARMV8_L0_TABLE_ENTRY_FIX(_idx)
#define ARMV8_L1_TABLE_ENTRY(_idx0) ARMV8_L1_TABLE_ENTRY_FIX(_idx0)
#endif

union armv8_ptable {
    armv8_ptable_l0_t l0;
    armv8_ptable_l1_t l1;
};


const union armv8_ptable  armv8_ptable[ARMV8_PTABLES_NUM]
    __attribute__((aligned(ARMV8_PTABLE_ALIGNMENT), section(".pagetables"))) =
{
    /*
     * ============================================================================================
     * L0 Table (Root)  -> Mapps 512GB per slot, one slot set
     * ============================================================================================
     */
{ .l0 = {
        [0] = ARMV8_L0_TABLE_ENTRY(1),
        [1] = ARMV8_L0_ENTRY_INVALID,
        [2] = ARMV8_L0_ENTRY_INVALID,
        [3] = ARMV8_L0_ENTRY_INVALID,
        [4] = ARMV8_L0_ENTRY_INVALID,
        [5] = ARMV8_L0_ENTRY_INVALID,
        [6] = ARMV8_L0_ENTRY_INVALID,
        [7] = ARMV8_L0_ENTRY_INVALID,
        [8] = ARMV8_L0_ENTRY_INVALID,
        [9] = ARMV8_L0_ENTRY_INVALID,
        [10] = ARMV8_L0_ENTRY_INVALID,
        [11] = ARMV8_L0_ENTRY_INVALID,
        [12] = ARMV8_L0_ENTRY_INVALID,
        [13] = ARMV8_L0_ENTRY_INVALID,
        [14] = ARMV8_L0_ENTRY_INVALID,
        [15] = ARMV8_L0_ENTRY_INVALID,
        [16] = ARMV8_L0_ENTRY_INVALID,
        [17] = ARMV8_L0_ENTRY_INVALID,
        [18] = ARMV8_L0_ENTRY_INVALID,
        [19] = ARMV8_L0_ENTRY_INVALID,
        [20] = ARMV8_L0_ENTRY_INVALID,
        [21] = ARMV8_L0_ENTRY_INVALID,
        [22] = ARMV8_L0_ENTRY_INVALID,
        [23] = ARMV8_L0_ENTRY_INVALID,
        [24] = ARMV8_L0_ENTRY_INVALID,
        [25] = ARMV8_L0_ENTRY_INVALID,
        [26] = ARMV8_L0_ENTRY_INVALID,
        [27] = ARMV8_L0_ENTRY_INVALID,
        [28] = ARMV8_L0_ENTRY_INVALID,
        [29] = ARMV8_L0_ENTRY_INVALID,
        [30] = ARMV8_L0_ENTRY_INVALID,
        [31] = ARMV8_L0_ENTRY_INVALID,
        [32] = ARMV8_L0_ENTRY_INVALID,
        [33] = ARMV8_L0_ENTRY_INVALID,
        [34] = ARMV8_L0_ENTRY_INVALID,
        [35] = ARMV8_L0_ENTRY_INVALID,
        [36] = ARMV8_L0_ENTRY_INVALID,
        [37] = ARMV8_L0_ENTRY_INVALID,
        [38] = ARMV8_L0_ENTRY_INVALID,
        [39] = ARMV8_L0_ENTRY_INVALID,
        [40] = ARMV8_L0_ENTRY_INVALID,
        [41] = ARMV8_L0_ENTRY_INVALID,
        [42] = ARMV8_L0_ENTRY_INVALID,
        [43] = ARMV8_L0_ENTRY_INVALID,
        [44] = ARMV8_L0_ENTRY_INVALID,
        [45] = ARMV8_L0_ENTRY_INVALID,
        [46] = ARMV8_L0_ENTRY_INVALID,
        [47] = ARMV8_L0_ENTRY_INVALID,
        [48] = ARMV8_L0_ENTRY_INVALID,
        [49] = ARMV8_L0_ENTRY_INVALID,
        [50] = ARMV8_L0_ENTRY_INVALID,
        [51] = ARMV8_L0_ENTRY_INVALID,
        [52] = ARMV8_L0_ENTRY_INVALID,
        [53] = ARMV8_L0_ENTRY_INVALID,
        [54] = ARMV8_L0_ENTRY_INVALID,
        [55] = ARMV8_L0_ENTRY_INVALID,
        [56] = ARMV8_L0_ENTRY_INVALID,
        [57] = ARMV8_L0_ENTRY_INVALID,
        [58] = ARMV8_L0_ENTRY_INVALID,
        [59] = ARMV8_L0_ENTRY_INVALID,
        [60] = ARMV8_L0_ENTRY_INVALID,
        [61] = ARMV8_L0_ENTRY_INVALID,
        [62] = ARMV8_L0_ENTRY_INVALID,
        [63] = ARMV8_L0_ENTRY_INVALID,
        [64] = ARMV8_L0_ENTRY_INVALID,
        [65] = ARMV8_L0_ENTRY_INVALID,
        [66] = ARMV8_L0_ENTRY_INVALID,
        [67] = ARMV8_L0_ENTRY_INVALID,
        [68] = ARMV8_L0_ENTRY_INVALID,
        [69] = ARMV8_L0_ENTRY_INVALID,
        [70] = ARMV8_L0_ENTRY_INVALID,
        [71] = ARMV8_L0_ENTRY_INVALID,
        [72] = ARMV8_L0_ENTRY_INVALID,
        [73] = ARMV8_L0_ENTRY_INVALID,
        [74] = ARMV8_L0_ENTRY_INVALID,
        [75] = ARMV8_L0_ENTRY_INVALID,
        [76] = ARMV8_L0_ENTRY_INVALID,
        [77] = ARMV8_L0_ENTRY_INVALID,
        [78] = ARMV8_L0_ENTRY_INVALID,
        [79] = ARMV8_L0_ENTRY_INVALID,
        [80] = ARMV8_L0_ENTRY_INVALID,
        [81] = ARMV8_L0_ENTRY_INVALID,
        [82] = ARMV8_L0_ENTRY_INVALID,
        [83] = ARMV8_L0_ENTRY_INVALID,
        [84] = ARMV8_L0_ENTRY_INVALID,
        [85] = ARMV8_L0_ENTRY_INVALID,
        [86] = ARMV8_L0_ENTRY_INVALID,
        [87] = ARMV8_L0_ENTRY_INVALID,
        [88] = ARMV8_L0_ENTRY_INVALID,
        [89] = ARMV8_L0_ENTRY_INVALID,
        [90] = ARMV8_L0_ENTRY_INVALID,
        [91] = ARMV8_L0_ENTRY_INVALID,
        [92] = ARMV8_L0_ENTRY_INVALID,
        [93] = ARMV8_L0_ENTRY_INVALID,
        [94] = ARMV8_L0_ENTRY_INVALID,
        [95] = ARMV8_L0_ENTRY_INVALID,
        [96] = ARMV8_L0_ENTRY_INVALID,
        [97] = ARMV8_L0_ENTRY_INVALID,
        [98] = ARMV8_L0_ENTRY_INVALID,
        [99] = ARMV8_L0_ENTRY_INVALID,
        [100] = ARMV8_L0_ENTRY_INVALID,
        [101] = ARMV8_L0_ENTRY_INVALID,
        [102] = ARMV8_L0_ENTRY_INVALID,
        [103] = ARMV8_L0_ENTRY_INVALID,
        [104] = ARMV8_L0_ENTRY_INVALID,
        [105] = ARMV8_L0_ENTRY_INVALID,
        [106] = ARMV8_L0_ENTRY_INVALID,
        [107] = ARMV8_L0_ENTRY_INVALID,
        [108] = ARMV8_L0_ENTRY_INVALID,
        [109] = ARMV8_L0_ENTRY_INVALID,
        [110] = ARMV8_L0_ENTRY_INVALID,
        [111] = ARMV8_L0_ENTRY_INVALID,
        [112] = ARMV8_L0_ENTRY_INVALID,
        [113] = ARMV8_L0_ENTRY_INVALID,
        [114] = ARMV8_L0_ENTRY_INVALID,
        [115] = ARMV8_L0_ENTRY_INVALID,
        [116] = ARMV8_L0_ENTRY_INVALID,
        [117] = ARMV8_L0_ENTRY_INVALID,
        [118] = ARMV8_L0_ENTRY_INVALID,
        [119] = ARMV8_L0_ENTRY_INVALID,
        [120] = ARMV8_L0_ENTRY_INVALID,
        [121] = ARMV8_L0_ENTRY_INVALID,
        [122] = ARMV8_L0_ENTRY_INVALID,
        [123] = ARMV8_L0_ENTRY_INVALID,
        [124] = ARMV8_L0_ENTRY_INVALID,
        [125] = ARMV8_L0_ENTRY_INVALID,
        [126] = ARMV8_L0_ENTRY_INVALID,
        [127] = ARMV8_L0_ENTRY_INVALID,
        [128] = ARMV8_L0_ENTRY_INVALID,
        [129] = ARMV8_L0_ENTRY_INVALID,
        [130] = ARMV8_L0_ENTRY_INVALID,
        [131] = ARMV8_L0_ENTRY_INVALID,
        [132] = ARMV8_L0_ENTRY_INVALID,
        [133] = ARMV8_L0_ENTRY_INVALID,
        [134] = ARMV8_L0_ENTRY_INVALID,
        [135] = ARMV8_L0_ENTRY_INVALID,
        [136] = ARMV8_L0_ENTRY_INVALID,
        [137] = ARMV8_L0_ENTRY_INVALID,
        [138] = ARMV8_L0_ENTRY_INVALID,
        [139] = ARMV8_L0_ENTRY_INVALID,
        [140] = ARMV8_L0_ENTRY_INVALID,
        [141] = ARMV8_L0_ENTRY_INVALID,
        [142] = ARMV8_L0_ENTRY_INVALID,
        [143] = ARMV8_L0_ENTRY_INVALID,
        [144] = ARMV8_L0_ENTRY_INVALID,
        [145] = ARMV8_L0_ENTRY_INVALID,
        [146] = ARMV8_L0_ENTRY_INVALID,
        [147] = ARMV8_L0_ENTRY_INVALID,
        [148] = ARMV8_L0_ENTRY_INVALID,
        [149] = ARMV8_L0_ENTRY_INVALID,
        [150] = ARMV8_L0_ENTRY_INVALID,
        [151] = ARMV8_L0_ENTRY_INVALID,
        [152] = ARMV8_L0_ENTRY_INVALID,
        [153] = ARMV8_L0_ENTRY_INVALID,
        [154] = ARMV8_L0_ENTRY_INVALID,
        [155] = ARMV8_L0_ENTRY_INVALID,
        [156] = ARMV8_L0_ENTRY_INVALID,
        [157] = ARMV8_L0_ENTRY_INVALID,
        [158] = ARMV8_L0_ENTRY_INVALID,
        [159] = ARMV8_L0_ENTRY_INVALID,
        [160] = ARMV8_L0_ENTRY_INVALID,
        [161] = ARMV8_L0_ENTRY_INVALID,
        [162] = ARMV8_L0_ENTRY_INVALID,
        [163] = ARMV8_L0_ENTRY_INVALID,
        [164] = ARMV8_L0_ENTRY_INVALID,
        [165] = ARMV8_L0_ENTRY_INVALID,
        [166] = ARMV8_L0_ENTRY_INVALID,
        [167] = ARMV8_L0_ENTRY_INVALID,
        [168] = ARMV8_L0_ENTRY_INVALID,
        [169] = ARMV8_L0_ENTRY_INVALID,
        [170] = ARMV8_L0_ENTRY_INVALID,
        [171] = ARMV8_L0_ENTRY_INVALID,
        [172] = ARMV8_L0_ENTRY_INVALID,
        [173] = ARMV8_L0_ENTRY_INVALID,
        [174] = ARMV8_L0_ENTRY_INVALID,
        [175] = ARMV8_L0_ENTRY_INVALID,
        [176] = ARMV8_L0_ENTRY_INVALID,
        [177] = ARMV8_L0_ENTRY_INVALID,
        [178] = ARMV8_L0_ENTRY_INVALID,
        [179] = ARMV8_L0_ENTRY_INVALID,
        [180] = ARMV8_L0_ENTRY_INVALID,
        [181] = ARMV8_L0_ENTRY_INVALID,
        [182] = ARMV8_L0_ENTRY_INVALID,
        [183] = ARMV8_L0_ENTRY_INVALID,
        [184] = ARMV8_L0_ENTRY_INVALID,
        [185] = ARMV8_L0_ENTRY_INVALID,
        [186] = ARMV8_L0_ENTRY_INVALID,
        [187] = ARMV8_L0_ENTRY_INVALID,
        [188] = ARMV8_L0_ENTRY_INVALID,
        [189] = ARMV8_L0_ENTRY_INVALID,
        [190] = ARMV8_L0_ENTRY_INVALID,
        [191] = ARMV8_L0_ENTRY_INVALID,
        [192] = ARMV8_L0_ENTRY_INVALID,
        [193] = ARMV8_L0_ENTRY_INVALID,
        [194] = ARMV8_L0_ENTRY_INVALID,
        [195] = ARMV8_L0_ENTRY_INVALID,
        [196] = ARMV8_L0_ENTRY_INVALID,
        [197] = ARMV8_L0_ENTRY_INVALID,
        [198] = ARMV8_L0_ENTRY_INVALID,
        [199] = ARMV8_L0_ENTRY_INVALID,
        [200] = ARMV8_L0_ENTRY_INVALID,
        [201] = ARMV8_L0_ENTRY_INVALID,
        [202] = ARMV8_L0_ENTRY_INVALID,
        [203] = ARMV8_L0_ENTRY_INVALID,
        [204] = ARMV8_L0_ENTRY_INVALID,
        [205] = ARMV8_L0_ENTRY_INVALID,
        [206] = ARMV8_L0_ENTRY_INVALID,
        [207] = ARMV8_L0_ENTRY_INVALID,
        [208] = ARMV8_L0_ENTRY_INVALID,
        [209] = ARMV8_L0_ENTRY_INVALID,
        [210] = ARMV8_L0_ENTRY_INVALID,
        [211] = ARMV8_L0_ENTRY_INVALID,
        [212] = ARMV8_L0_ENTRY_INVALID,
        [213] = ARMV8_L0_ENTRY_INVALID,
        [214] = ARMV8_L0_ENTRY_INVALID,
        [215] = ARMV8_L0_ENTRY_INVALID,
        [216] = ARMV8_L0_ENTRY_INVALID,
        [217] = ARMV8_L0_ENTRY_INVALID,
        [218] = ARMV8_L0_ENTRY_INVALID,
        [219] = ARMV8_L0_ENTRY_INVALID,
        [220] = ARMV8_L0_ENTRY_INVALID,
        [221] = ARMV8_L0_ENTRY_INVALID,
        [222] = ARMV8_L0_ENTRY_INVALID,
        [223] = ARMV8_L0_ENTRY_INVALID,
        [224] = ARMV8_L0_ENTRY_INVALID,
        [225] = ARMV8_L0_ENTRY_INVALID,
        [226] = ARMV8_L0_ENTRY_INVALID,
        [227] = ARMV8_L0_ENTRY_INVALID,
        [228] = ARMV8_L0_ENTRY_INVALID,
        [229] = ARMV8_L0_ENTRY_INVALID,
        [230] = ARMV8_L0_ENTRY_INVALID,
        [231] = ARMV8_L0_ENTRY_INVALID,
        [232] = ARMV8_L0_ENTRY_INVALID,
        [233] = ARMV8_L0_ENTRY_INVALID,
        [234] = ARMV8_L0_ENTRY_INVALID,
        [235] = ARMV8_L0_ENTRY_INVALID,
        [236] = ARMV8_L0_ENTRY_INVALID,
        [237] = ARMV8_L0_ENTRY_INVALID,
        [238] = ARMV8_L0_ENTRY_INVALID,
        [239] = ARMV8_L0_ENTRY_INVALID,
        [240] = ARMV8_L0_ENTRY_INVALID,
        [241] = ARMV8_L0_ENTRY_INVALID,
        [242] = ARMV8_L0_ENTRY_INVALID,
        [243] = ARMV8_L0_ENTRY_INVALID,
        [244] = ARMV8_L0_ENTRY_INVALID,
        [245] = ARMV8_L0_ENTRY_INVALID,
        [246] = ARMV8_L0_ENTRY_INVALID,
        [247] = ARMV8_L0_ENTRY_INVALID,
        [248] = ARMV8_L0_ENTRY_INVALID,
        [249] = ARMV8_L0_ENTRY_INVALID,
        [250] = ARMV8_L0_ENTRY_INVALID,
        [251] = ARMV8_L0_ENTRY_INVALID,
        [252] = ARMV8_L0_ENTRY_INVALID,
        [253] = ARMV8_L0_ENTRY_INVALID,
        [254] = ARMV8_L0_ENTRY_INVALID,
        [255] = ARMV8_L0_ENTRY_INVALID,
        [256] = ARMV8_L0_ENTRY_INVALID,
        [257] = ARMV8_L0_ENTRY_INVALID,
        [258] = ARMV8_L0_ENTRY_INVALID,
        [259] = ARMV8_L0_ENTRY_INVALID,
        [260] = ARMV8_L0_ENTRY_INVALID,
        [261] = ARMV8_L0_ENTRY_INVALID,
        [262] = ARMV8_L0_ENTRY_INVALID,
        [263] = ARMV8_L0_ENTRY_INVALID,
        [264] = ARMV8_L0_ENTRY_INVALID,
        [265] = ARMV8_L0_ENTRY_INVALID,
        [266] = ARMV8_L0_ENTRY_INVALID,
        [267] = ARMV8_L0_ENTRY_INVALID,
        [268] = ARMV8_L0_ENTRY_INVALID,
        [269] = ARMV8_L0_ENTRY_INVALID,
        [270] = ARMV8_L0_ENTRY_INVALID,
        [271] = ARMV8_L0_ENTRY_INVALID,
        [272] = ARMV8_L0_ENTRY_INVALID,
        [273] = ARMV8_L0_ENTRY_INVALID,
        [274] = ARMV8_L0_ENTRY_INVALID,
        [275] = ARMV8_L0_ENTRY_INVALID,
        [276] = ARMV8_L0_ENTRY_INVALID,
        [277] = ARMV8_L0_ENTRY_INVALID,
        [278] = ARMV8_L0_ENTRY_INVALID,
        [279] = ARMV8_L0_ENTRY_INVALID,
        [280] = ARMV8_L0_ENTRY_INVALID,
        [281] = ARMV8_L0_ENTRY_INVALID,
        [282] = ARMV8_L0_ENTRY_INVALID,
        [283] = ARMV8_L0_ENTRY_INVALID,
        [284] = ARMV8_L0_ENTRY_INVALID,
        [285] = ARMV8_L0_ENTRY_INVALID,
        [286] = ARMV8_L0_ENTRY_INVALID,
        [287] = ARMV8_L0_ENTRY_INVALID,
        [288] = ARMV8_L0_ENTRY_INVALID,
        [289] = ARMV8_L0_ENTRY_INVALID,
        [290] = ARMV8_L0_ENTRY_INVALID,
        [291] = ARMV8_L0_ENTRY_INVALID,
        [292] = ARMV8_L0_ENTRY_INVALID,
        [293] = ARMV8_L0_ENTRY_INVALID,
        [294] = ARMV8_L0_ENTRY_INVALID,
        [295] = ARMV8_L0_ENTRY_INVALID,
        [296] = ARMV8_L0_ENTRY_INVALID,
        [297] = ARMV8_L0_ENTRY_INVALID,
        [298] = ARMV8_L0_ENTRY_INVALID,
        [299] = ARMV8_L0_ENTRY_INVALID,
        [300] = ARMV8_L0_ENTRY_INVALID,
        [301] = ARMV8_L0_ENTRY_INVALID,
        [302] = ARMV8_L0_ENTRY_INVALID,
        [303] = ARMV8_L0_ENTRY_INVALID,
        [304] = ARMV8_L0_ENTRY_INVALID,
        [305] = ARMV8_L0_ENTRY_INVALID,
        [306] = ARMV8_L0_ENTRY_INVALID,
        [307] = ARMV8_L0_ENTRY_INVALID,
        [308] = ARMV8_L0_ENTRY_INVALID,
        [309] = ARMV8_L0_ENTRY_INVALID,
        [310] = ARMV8_L0_ENTRY_INVALID,
        [311] = ARMV8_L0_ENTRY_INVALID,
        [312] = ARMV8_L0_ENTRY_INVALID,
        [313] = ARMV8_L0_ENTRY_INVALID,
        [314] = ARMV8_L0_ENTRY_INVALID,
        [315] = ARMV8_L0_ENTRY_INVALID,
        [316] = ARMV8_L0_ENTRY_INVALID,
        [317] = ARMV8_L0_ENTRY_INVALID,
        [318] = ARMV8_L0_ENTRY_INVALID,
        [319] = ARMV8_L0_ENTRY_INVALID,
        [320] = ARMV8_L0_ENTRY_INVALID,
        [321] = ARMV8_L0_ENTRY_INVALID,
        [322] = ARMV8_L0_ENTRY_INVALID,
        [323] = ARMV8_L0_ENTRY_INVALID,
        [324] = ARMV8_L0_ENTRY_INVALID,
        [325] = ARMV8_L0_ENTRY_INVALID,
        [326] = ARMV8_L0_ENTRY_INVALID,
        [327] = ARMV8_L0_ENTRY_INVALID,
        [328] = ARMV8_L0_ENTRY_INVALID,
        [329] = ARMV8_L0_ENTRY_INVALID,
        [330] = ARMV8_L0_ENTRY_INVALID,
        [331] = ARMV8_L0_ENTRY_INVALID,
        [332] = ARMV8_L0_ENTRY_INVALID,
        [333] = ARMV8_L0_ENTRY_INVALID,
        [334] = ARMV8_L0_ENTRY_INVALID,
        [335] = ARMV8_L0_ENTRY_INVALID,
        [336] = ARMV8_L0_ENTRY_INVALID,
        [337] = ARMV8_L0_ENTRY_INVALID,
        [338] = ARMV8_L0_ENTRY_INVALID,
        [339] = ARMV8_L0_ENTRY_INVALID,
        [340] = ARMV8_L0_ENTRY_INVALID,
        [341] = ARMV8_L0_ENTRY_INVALID,
        [342] = ARMV8_L0_ENTRY_INVALID,
        [343] = ARMV8_L0_ENTRY_INVALID,
        [344] = ARMV8_L0_ENTRY_INVALID,
        [345] = ARMV8_L0_ENTRY_INVALID,
        [346] = ARMV8_L0_ENTRY_INVALID,
        [347] = ARMV8_L0_ENTRY_INVALID,
        [348] = ARMV8_L0_ENTRY_INVALID,
        [349] = ARMV8_L0_ENTRY_INVALID,
        [350] = ARMV8_L0_ENTRY_INVALID,
        [351] = ARMV8_L0_ENTRY_INVALID,
        [352] = ARMV8_L0_ENTRY_INVALID,
        [353] = ARMV8_L0_ENTRY_INVALID,
        [354] = ARMV8_L0_ENTRY_INVALID,
        [355] = ARMV8_L0_ENTRY_INVALID,
        [356] = ARMV8_L0_ENTRY_INVALID,
        [357] = ARMV8_L0_ENTRY_INVALID,
        [358] = ARMV8_L0_ENTRY_INVALID,
        [359] = ARMV8_L0_ENTRY_INVALID,
        [360] = ARMV8_L0_ENTRY_INVALID,
        [361] = ARMV8_L0_ENTRY_INVALID,
        [362] = ARMV8_L0_ENTRY_INVALID,
        [363] = ARMV8_L0_ENTRY_INVALID,
        [364] = ARMV8_L0_ENTRY_INVALID,
        [365] = ARMV8_L0_ENTRY_INVALID,
        [366] = ARMV8_L0_ENTRY_INVALID,
        [367] = ARMV8_L0_ENTRY_INVALID,
        [368] = ARMV8_L0_ENTRY_INVALID,
        [369] = ARMV8_L0_ENTRY_INVALID,
        [370] = ARMV8_L0_ENTRY_INVALID,
        [371] = ARMV8_L0_ENTRY_INVALID,
        [372] = ARMV8_L0_ENTRY_INVALID,
        [373] = ARMV8_L0_ENTRY_INVALID,
        [374] = ARMV8_L0_ENTRY_INVALID,
        [375] = ARMV8_L0_ENTRY_INVALID,
        [376] = ARMV8_L0_ENTRY_INVALID,
        [377] = ARMV8_L0_ENTRY_INVALID,
        [378] = ARMV8_L0_ENTRY_INVALID,
        [379] = ARMV8_L0_ENTRY_INVALID,
        [380] = ARMV8_L0_ENTRY_INVALID,
        [381] = ARMV8_L0_ENTRY_INVALID,
        [382] = ARMV8_L0_ENTRY_INVALID,
        [383] = ARMV8_L0_ENTRY_INVALID,
        [384] = ARMV8_L0_ENTRY_INVALID,
        [385] = ARMV8_L0_ENTRY_INVALID,
        [386] = ARMV8_L0_ENTRY_INVALID,
        [387] = ARMV8_L0_ENTRY_INVALID,
        [388] = ARMV8_L0_ENTRY_INVALID,
        [389] = ARMV8_L0_ENTRY_INVALID,
        [390] = ARMV8_L0_ENTRY_INVALID,
        [391] = ARMV8_L0_ENTRY_INVALID,
        [392] = ARMV8_L0_ENTRY_INVALID,
        [393] = ARMV8_L0_ENTRY_INVALID,
        [394] = ARMV8_L0_ENTRY_INVALID,
        [395] = ARMV8_L0_ENTRY_INVALID,
        [396] = ARMV8_L0_ENTRY_INVALID,
        [397] = ARMV8_L0_ENTRY_INVALID,
        [398] = ARMV8_L0_ENTRY_INVALID,
        [399] = ARMV8_L0_ENTRY_INVALID,
        [400] = ARMV8_L0_ENTRY_INVALID,
        [401] = ARMV8_L0_ENTRY_INVALID,
        [402] = ARMV8_L0_ENTRY_INVALID,
        [403] = ARMV8_L0_ENTRY_INVALID,
        [404] = ARMV8_L0_ENTRY_INVALID,
        [405] = ARMV8_L0_ENTRY_INVALID,
        [406] = ARMV8_L0_ENTRY_INVALID,
        [407] = ARMV8_L0_ENTRY_INVALID,
        [408] = ARMV8_L0_ENTRY_INVALID,
        [409] = ARMV8_L0_ENTRY_INVALID,
        [410] = ARMV8_L0_ENTRY_INVALID,
        [411] = ARMV8_L0_ENTRY_INVALID,
        [412] = ARMV8_L0_ENTRY_INVALID,
        [413] = ARMV8_L0_ENTRY_INVALID,
        [414] = ARMV8_L0_ENTRY_INVALID,
        [415] = ARMV8_L0_ENTRY_INVALID,
        [416] = ARMV8_L0_ENTRY_INVALID,
        [417] = ARMV8_L0_ENTRY_INVALID,
        [418] = ARMV8_L0_ENTRY_INVALID,
        [419] = ARMV8_L0_ENTRY_INVALID,
        [420] = ARMV8_L0_ENTRY_INVALID,
        [421] = ARMV8_L0_ENTRY_INVALID,
        [422] = ARMV8_L0_ENTRY_INVALID,
        [423] = ARMV8_L0_ENTRY_INVALID,
        [424] = ARMV8_L0_ENTRY_INVALID,
        [425] = ARMV8_L0_ENTRY_INVALID,
        [426] = ARMV8_L0_ENTRY_INVALID,
        [427] = ARMV8_L0_ENTRY_INVALID,
        [428] = ARMV8_L0_ENTRY_INVALID,
        [429] = ARMV8_L0_ENTRY_INVALID,
        [430] = ARMV8_L0_ENTRY_INVALID,
        [431] = ARMV8_L0_ENTRY_INVALID,
        [432] = ARMV8_L0_ENTRY_INVALID,
        [433] = ARMV8_L0_ENTRY_INVALID,
        [434] = ARMV8_L0_ENTRY_INVALID,
        [435] = ARMV8_L0_ENTRY_INVALID,
        [436] = ARMV8_L0_ENTRY_INVALID,
        [437] = ARMV8_L0_ENTRY_INVALID,
        [438] = ARMV8_L0_ENTRY_INVALID,
        [439] = ARMV8_L0_ENTRY_INVALID,
        [440] = ARMV8_L0_ENTRY_INVALID,
        [441] = ARMV8_L0_ENTRY_INVALID,
        [442] = ARMV8_L0_ENTRY_INVALID,
        [443] = ARMV8_L0_ENTRY_INVALID,
        [444] = ARMV8_L0_ENTRY_INVALID,
        [445] = ARMV8_L0_ENTRY_INVALID,
        [446] = ARMV8_L0_ENTRY_INVALID,
        [447] = ARMV8_L0_ENTRY_INVALID,
        [448] = ARMV8_L0_ENTRY_INVALID,
        [449] = ARMV8_L0_ENTRY_INVALID,
        [450] = ARMV8_L0_ENTRY_INVALID,
        [451] = ARMV8_L0_ENTRY_INVALID,
        [452] = ARMV8_L0_ENTRY_INVALID,
        [453] = ARMV8_L0_ENTRY_INVALID,
        [454] = ARMV8_L0_ENTRY_INVALID,
        [455] = ARMV8_L0_ENTRY_INVALID,
        [456] = ARMV8_L0_ENTRY_INVALID,
        [457] = ARMV8_L0_ENTRY_INVALID,
        [458] = ARMV8_L0_ENTRY_INVALID,
        [459] = ARMV8_L0_ENTRY_INVALID,
        [460] = ARMV8_L0_ENTRY_INVALID,
        [461] = ARMV8_L0_ENTRY_INVALID,
        [462] = ARMV8_L0_ENTRY_INVALID,
        [463] = ARMV8_L0_ENTRY_INVALID,
        [464] = ARMV8_L0_ENTRY_INVALID,
        [465] = ARMV8_L0_ENTRY_INVALID,
        [466] = ARMV8_L0_ENTRY_INVALID,
        [467] = ARMV8_L0_ENTRY_INVALID,
        [468] = ARMV8_L0_ENTRY_INVALID,
        [469] = ARMV8_L0_ENTRY_INVALID,
        [470] = ARMV8_L0_ENTRY_INVALID,
        [471] = ARMV8_L0_ENTRY_INVALID,
        [472] = ARMV8_L0_ENTRY_INVALID,
        [473] = ARMV8_L0_ENTRY_INVALID,
        [474] = ARMV8_L0_ENTRY_INVALID,
        [475] = ARMV8_L0_ENTRY_INVALID,
        [476] = ARMV8_L0_ENTRY_INVALID,
        [477] = ARMV8_L0_ENTRY_INVALID,
        [478] = ARMV8_L0_ENTRY_INVALID,
        [479] = ARMV8_L0_ENTRY_INVALID,
        [480] = ARMV8_L0_ENTRY_INVALID,
        [481] = ARMV8_L0_ENTRY_INVALID,
        [482] = ARMV8_L0_ENTRY_INVALID,
        [483] = ARMV8_L0_ENTRY_INVALID,
        [484] = ARMV8_L0_ENTRY_INVALID,
        [485] = ARMV8_L0_ENTRY_INVALID,
        [486] = ARMV8_L0_ENTRY_INVALID,
        [487] = ARMV8_L0_ENTRY_INVALID,
        [488] = ARMV8_L0_ENTRY_INVALID,
        [489] = ARMV8_L0_ENTRY_INVALID,
        [490] = ARMV8_L0_ENTRY_INVALID,
        [491] = ARMV8_L0_ENTRY_INVALID,
        [492] = ARMV8_L0_ENTRY_INVALID,
        [493] = ARMV8_L0_ENTRY_INVALID,
        [494] = ARMV8_L0_ENTRY_INVALID,
        [495] = ARMV8_L0_ENTRY_INVALID,
        [496] = ARMV8_L0_ENTRY_INVALID,
        [497] = ARMV8_L0_ENTRY_INVALID,
        [498] = ARMV8_L0_ENTRY_INVALID,
        [499] = ARMV8_L0_ENTRY_INVALID,
        [500] = ARMV8_L0_ENTRY_INVALID,
        [501] = ARMV8_L0_ENTRY_INVALID,
        [502] = ARMV8_L0_ENTRY_INVALID,
        [503] = ARMV8_L0_ENTRY_INVALID,
        [504] = ARMV8_L0_ENTRY_INVALID,
        [505] = ARMV8_L0_ENTRY_INVALID,
        [506] = ARMV8_L0_ENTRY_INVALID,
        [507] = ARMV8_L0_ENTRY_INVALID,
        [508] = ARMV8_L0_ENTRY_INVALID,
        [509] = ARMV8_L0_ENTRY_INVALID,
        [510] = ARMV8_L0_ENTRY_INVALID,
        [511] = ARMV8_L0_ENTRY_INVALID
}
},


    /*
     * ============================================================================================
     * L1 Table -> MAPS 1GB per slot, maps 2GB of DRAM
     * ============================================================================================
     */
{ .l1 = {
        /* VA: 0x00000000 .. 0x3fffffff */
        [0] = ARMV8_L1_DEVICE_ENTRY(0x00000000ULL),
        /* VA: 0x40000000 .. 0x7fffffff */
        [1] = ARMV8_L1_ENTRY_INVALID,
        /* VA: 0x80000000 .. 0xbfffffff */
        [2] = ARMV8_L1_MEMORY_ENTRY(0x80000000ULL),
        /* VA: 0xc0000000 .. 0xffffffff */
        [3] = ARMV8_L1_MEMORY_ENTRY(0xC0000000ULL),
        [4] = ARMV8_L1_ENTRY_INVALID,
        [5] = ARMV8_L1_ENTRY_INVALID,
        [6] = ARMV8_L1_ENTRY_INVALID,
        [7] = ARMV8_L1_ENTRY_INVALID,
        [8] = ARMV8_L1_ENTRY_INVALID,
        [9] = ARMV8_L1_ENTRY_INVALID,
        [10] = ARMV8_L1_ENTRY_INVALID,
        [11] = ARMV8_L1_ENTRY_INVALID,
        [12] = ARMV8_L1_ENTRY_INVALID,
        [13] = ARMV8_L1_ENTRY_INVALID,
        [14] = ARMV8_L1_ENTRY_INVALID,
        [15] = ARMV8_L1_ENTRY_INVALID,
        [16] = ARMV8_L1_ENTRY_INVALID,
        [17] = ARMV8_L1_ENTRY_INVALID,
        [18] = ARMV8_L1_ENTRY_INVALID,
        [19] = ARMV8_L1_ENTRY_INVALID,
        [20] = ARMV8_L1_ENTRY_INVALID,
        [21] = ARMV8_L1_ENTRY_INVALID,
        [22] = ARMV8_L1_ENTRY_INVALID,
        [23] = ARMV8_L1_ENTRY_INVALID,
        [24] = ARMV8_L1_ENTRY_INVALID,
        [25] = ARMV8_L1_ENTRY_INVALID,
        [26] = ARMV8_L1_ENTRY_INVALID,
        [27] = ARMV8_L1_ENTRY_INVALID,
        [28] = ARMV8_L1_ENTRY_INVALID,
        [29] = ARMV8_L1_ENTRY_INVALID,
        [30] = ARMV8_L1_ENTRY_INVALID,
        [31] = ARMV8_L1_ENTRY_INVALID,
        [32] = ARMV8_L1_ENTRY_INVALID,
        [33] = ARMV8_L1_ENTRY_INVALID,
        [34] = ARMV8_L1_ENTRY_INVALID,
        [35] = ARMV8_L1_ENTRY_INVALID,
        [36] = ARMV8_L1_ENTRY_INVALID,
        [37] = ARMV8_L1_ENTRY_INVALID,
        [38] = ARMV8_L1_ENTRY_INVALID,
        [39] = ARMV8_L1_ENTRY_INVALID,
        [40] = ARMV8_L1_ENTRY_INVALID,
        [41] = ARMV8_L1_ENTRY_INVALID,
        [42] = ARMV8_L1_ENTRY_INVALID,
        [43] = ARMV8_L1_ENTRY_INVALID,
        [44] = ARMV8_L1_ENTRY_INVALID,
        [45] = ARMV8_L1_ENTRY_INVALID,
        [46] = ARMV8_L1_ENTRY_INVALID,
        [47] = ARMV8_L1_ENTRY_INVALID,
        [48] = ARMV8_L1_ENTRY_INVALID,
        [49] = ARMV8_L1_ENTRY_INVALID,
        [50] = ARMV8_L1_ENTRY_INVALID,
        [51] = ARMV8_L1_ENTRY_INVALID,
        [52] = ARMV8_L1_ENTRY_INVALID,
        [53] = ARMV8_L1_ENTRY_INVALID,
        [54] = ARMV8_L1_ENTRY_INVALID,
        [55] = ARMV8_L1_ENTRY_INVALID,
        [56] = ARMV8_L1_ENTRY_INVALID,
        [57] = ARMV8_L1_ENTRY_INVALID,
        [58] = ARMV8_L1_ENTRY_INVALID,
        [59] = ARMV8_L1_ENTRY_INVALID,
        [60] = ARMV8_L1_ENTRY_INVALID,
        [61] = ARMV8_L1_ENTRY_INVALID,
        [62] = ARMV8_L1_ENTRY_INVALID,
        [63] = ARMV8_L1_ENTRY_INVALID,
        [64] = ARMV8_L1_ENTRY_INVALID,
        [65] = ARMV8_L1_ENTRY_INVALID,
        [66] = ARMV8_L1_ENTRY_INVALID,
        [67] = ARMV8_L1_ENTRY_INVALID,
        [68] = ARMV8_L1_ENTRY_INVALID,
        [69] = ARMV8_L1_ENTRY_INVALID,
        [70] = ARMV8_L1_ENTRY_INVALID,
        [71] = ARMV8_L1_ENTRY_INVALID,
        [72] = ARMV8_L1_ENTRY_INVALID,
        [73] = ARMV8_L1_ENTRY_INVALID,
        [74] = ARMV8_L1_ENTRY_INVALID,
        [75] = ARMV8_L1_ENTRY_INVALID,
        [76] = ARMV8_L1_ENTRY_INVALID,
        [77] = ARMV8_L1_ENTRY_INVALID,
        [78] = ARMV8_L1_ENTRY_INVALID,
        [79] = ARMV8_L1_ENTRY_INVALID,
        [80] = ARMV8_L1_ENTRY_INVALID,
        [81] = ARMV8_L1_ENTRY_INVALID,
        [82] = ARMV8_L1_ENTRY_INVALID,
        [83] = ARMV8_L1_ENTRY_INVALID,
        [84] = ARMV8_L1_ENTRY_INVALID,
        [85] = ARMV8_L1_ENTRY_INVALID,
        [86] = ARMV8_L1_ENTRY_INVALID,
        [87] = ARMV8_L1_ENTRY_INVALID,
        [88] = ARMV8_L1_ENTRY_INVALID,
        [89] = ARMV8_L1_ENTRY_INVALID,
        [90] = ARMV8_L1_ENTRY_INVALID,
        [91] = ARMV8_L1_ENTRY_INVALID,
        [92] = ARMV8_L1_ENTRY_INVALID,
        [93] = ARMV8_L1_ENTRY_INVALID,
        [94] = ARMV8_L1_ENTRY_INVALID,
        [95] = ARMV8_L1_ENTRY_INVALID,
        [96] = ARMV8_L1_ENTRY_INVALID,
        [97] = ARMV8_L1_ENTRY_INVALID,
        [98] = ARMV8_L1_ENTRY_INVALID,
        [99] = ARMV8_L1_ENTRY_INVALID,
        [100] = ARMV8_L1_ENTRY_INVALID,
        [101] = ARMV8_L1_ENTRY_INVALID,
        [102] = ARMV8_L1_ENTRY_INVALID,
        [103] = ARMV8_L1_ENTRY_INVALID,
        [104] = ARMV8_L1_ENTRY_INVALID,
        [105] = ARMV8_L1_ENTRY_INVALID,
        [106] = ARMV8_L1_ENTRY_INVALID,
        [107] = ARMV8_L1_ENTRY_INVALID,
        [108] = ARMV8_L1_ENTRY_INVALID,
        [109] = ARMV8_L1_ENTRY_INVALID,
        [110] = ARMV8_L1_ENTRY_INVALID,
        [111] = ARMV8_L1_ENTRY_INVALID,
        [112] = ARMV8_L1_ENTRY_INVALID,
        [113] = ARMV8_L1_ENTRY_INVALID,
        [114] = ARMV8_L1_ENTRY_INVALID,
        [115] = ARMV8_L1_ENTRY_INVALID,
        [116] = ARMV8_L1_ENTRY_INVALID,
        [117] = ARMV8_L1_ENTRY_INVALID,
        [118] = ARMV8_L1_ENTRY_INVALID,
        [119] = ARMV8_L1_ENTRY_INVALID,
        [120] = ARMV8_L1_ENTRY_INVALID,
        [121] = ARMV8_L1_ENTRY_INVALID,
        [122] = ARMV8_L1_ENTRY_INVALID,
        [123] = ARMV8_L1_ENTRY_INVALID,
        [124] = ARMV8_L1_ENTRY_INVALID,
        [125] = ARMV8_L1_ENTRY_INVALID,
        [126] = ARMV8_L1_ENTRY_INVALID,
        [127] = ARMV8_L1_ENTRY_INVALID,
        [128] = ARMV8_L1_ENTRY_INVALID,
        [129] = ARMV8_L1_ENTRY_INVALID,
        [130] = ARMV8_L1_ENTRY_INVALID,
        [131] = ARMV8_L1_ENTRY_INVALID,
        [132] = ARMV8_L1_ENTRY_INVALID,
        [133] = ARMV8_L1_ENTRY_INVALID,
        [134] = ARMV8_L1_ENTRY_INVALID,
        [135] = ARMV8_L1_ENTRY_INVALID,
        [136] = ARMV8_L1_ENTRY_INVALID,
        [137] = ARMV8_L1_ENTRY_INVALID,
        [138] = ARMV8_L1_ENTRY_INVALID,
        [139] = ARMV8_L1_ENTRY_INVALID,
        [140] = ARMV8_L1_ENTRY_INVALID,
        [141] = ARMV8_L1_ENTRY_INVALID,
        [142] = ARMV8_L1_ENTRY_INVALID,
        [143] = ARMV8_L1_ENTRY_INVALID,
        [144] = ARMV8_L1_ENTRY_INVALID,
        [145] = ARMV8_L1_ENTRY_INVALID,
        [146] = ARMV8_L1_ENTRY_INVALID,
        [147] = ARMV8_L1_ENTRY_INVALID,
        [148] = ARMV8_L1_ENTRY_INVALID,
        [149] = ARMV8_L1_ENTRY_INVALID,
        [150] = ARMV8_L1_ENTRY_INVALID,
        [151] = ARMV8_L1_ENTRY_INVALID,
        [152] = ARMV8_L1_ENTRY_INVALID,
        [153] = ARMV8_L1_ENTRY_INVALID,
        [154] = ARMV8_L1_ENTRY_INVALID,
        [155] = ARMV8_L1_ENTRY_INVALID,
        [156] = ARMV8_L1_ENTRY_INVALID,
        [157] = ARMV8_L1_ENTRY_INVALID,
        [158] = ARMV8_L1_ENTRY_INVALID,
        [159] = ARMV8_L1_ENTRY_INVALID,
        [160] = ARMV8_L1_ENTRY_INVALID,
        [161] = ARMV8_L1_ENTRY_INVALID,
        [162] = ARMV8_L1_ENTRY_INVALID,
        [163] = ARMV8_L1_ENTRY_INVALID,
        [164] = ARMV8_L1_ENTRY_INVALID,
        [165] = ARMV8_L1_ENTRY_INVALID,
        [166] = ARMV8_L1_ENTRY_INVALID,
        [167] = ARMV8_L1_ENTRY_INVALID,
        [168] = ARMV8_L1_ENTRY_INVALID,
        [169] = ARMV8_L1_ENTRY_INVALID,
        [170] = ARMV8_L1_ENTRY_INVALID,
        [171] = ARMV8_L1_ENTRY_INVALID,
        [172] = ARMV8_L1_ENTRY_INVALID,
        [173] = ARMV8_L1_ENTRY_INVALID,
        [174] = ARMV8_L1_ENTRY_INVALID,
        [175] = ARMV8_L1_ENTRY_INVALID,
        [176] = ARMV8_L1_ENTRY_INVALID,
        [177] = ARMV8_L1_ENTRY_INVALID,
        [178] = ARMV8_L1_ENTRY_INVALID,
        [179] = ARMV8_L1_ENTRY_INVALID,
        [180] = ARMV8_L1_ENTRY_INVALID,
        [181] = ARMV8_L1_ENTRY_INVALID,
        [182] = ARMV8_L1_ENTRY_INVALID,
        [183] = ARMV8_L1_ENTRY_INVALID,
        [184] = ARMV8_L1_ENTRY_INVALID,
        [185] = ARMV8_L1_ENTRY_INVALID,
        [186] = ARMV8_L1_ENTRY_INVALID,
        [187] = ARMV8_L1_ENTRY_INVALID,
        [188] = ARMV8_L1_ENTRY_INVALID,
        [189] = ARMV8_L1_ENTRY_INVALID,
        [190] = ARMV8_L1_ENTRY_INVALID,
        [191] = ARMV8_L1_ENTRY_INVALID,
        [192] = ARMV8_L1_ENTRY_INVALID,
        [193] = ARMV8_L1_ENTRY_INVALID,
        [194] = ARMV8_L1_ENTRY_INVALID,
        [195] = ARMV8_L1_ENTRY_INVALID,
        [196] = ARMV8_L1_ENTRY_INVALID,
        [197] = ARMV8_L1_ENTRY_INVALID,
        [198] = ARMV8_L1_ENTRY_INVALID,
        [199] = ARMV8_L1_ENTRY_INVALID,
        [200] = ARMV8_L1_ENTRY_INVALID,
        [201] = ARMV8_L1_ENTRY_INVALID,
        [202] = ARMV8_L1_ENTRY_INVALID,
        [203] = ARMV8_L1_ENTRY_INVALID,
        [204] = ARMV8_L1_ENTRY_INVALID,
        [205] = ARMV8_L1_ENTRY_INVALID,
        [206] = ARMV8_L1_ENTRY_INVALID,
        [207] = ARMV8_L1_ENTRY_INVALID,
        [208] = ARMV8_L1_ENTRY_INVALID,
        [209] = ARMV8_L1_ENTRY_INVALID,
        [210] = ARMV8_L1_ENTRY_INVALID,
        [211] = ARMV8_L1_ENTRY_INVALID,
        [212] = ARMV8_L1_ENTRY_INVALID,
        [213] = ARMV8_L1_ENTRY_INVALID,
        [214] = ARMV8_L1_ENTRY_INVALID,
        [215] = ARMV8_L1_ENTRY_INVALID,
        [216] = ARMV8_L1_ENTRY_INVALID,
        [217] = ARMV8_L1_ENTRY_INVALID,
        [218] = ARMV8_L1_ENTRY_INVALID,
        [219] = ARMV8_L1_ENTRY_INVALID,
        [220] = ARMV8_L1_ENTRY_INVALID,
        [221] = ARMV8_L1_ENTRY_INVALID,
        [222] = ARMV8_L1_ENTRY_INVALID,
        [223] = ARMV8_L1_ENTRY_INVALID,
        [224] = ARMV8_L1_ENTRY_INVALID,
        [225] = ARMV8_L1_ENTRY_INVALID,
        [226] = ARMV8_L1_ENTRY_INVALID,
        [227] = ARMV8_L1_ENTRY_INVALID,
        [228] = ARMV8_L1_ENTRY_INVALID,
        [229] = ARMV8_L1_ENTRY_INVALID,
        [230] = ARMV8_L1_ENTRY_INVALID,
        [231] = ARMV8_L1_ENTRY_INVALID,
        [232] = ARMV8_L1_ENTRY_INVALID,
        [233] = ARMV8_L1_ENTRY_INVALID,
        [234] = ARMV8_L1_ENTRY_INVALID,
        [235] = ARMV8_L1_ENTRY_INVALID,
        [236] = ARMV8_L1_ENTRY_INVALID,
        [237] = ARMV8_L1_ENTRY_INVALID,
        [238] = ARMV8_L1_ENTRY_INVALID,
        [239] = ARMV8_L1_ENTRY_INVALID,
        [240] = ARMV8_L1_ENTRY_INVALID,
        [241] = ARMV8_L1_ENTRY_INVALID,
        [242] = ARMV8_L1_ENTRY_INVALID,
        [243] = ARMV8_L1_ENTRY_INVALID,
        [244] = ARMV8_L1_ENTRY_INVALID,
        [245] = ARMV8_L1_ENTRY_INVALID,
        [246] = ARMV8_L1_ENTRY_INVALID,
        [247] = ARMV8_L1_ENTRY_INVALID,
        [248] = ARMV8_L1_ENTRY_INVALID,
        [249] = ARMV8_L1_ENTRY_INVALID,
        [250] = ARMV8_L1_ENTRY_INVALID,
        [251] = ARMV8_L1_ENTRY_INVALID,
        [252] = ARMV8_L1_ENTRY_INVALID,
        [253] = ARMV8_L1_ENTRY_INVALID,
        [254] = ARMV8_L1_ENTRY_INVALID,
        [255] = ARMV8_L1_ENTRY_INVALID,
        [256] = ARMV8_L1_ENTRY_INVALID,
        [257] = ARMV8_L1_ENTRY_INVALID,
        [258] = ARMV8_L1_ENTRY_INVALID,
        [259] = ARMV8_L1_ENTRY_INVALID,
        [260] = ARMV8_L1_ENTRY_INVALID,
        [261] = ARMV8_L1_ENTRY_INVALID,
        [262] = ARMV8_L1_ENTRY_INVALID,
        [263] = ARMV8_L1_ENTRY_INVALID,
        [264] = ARMV8_L1_ENTRY_INVALID,
        [265] = ARMV8_L1_ENTRY_INVALID,
        [266] = ARMV8_L1_ENTRY_INVALID,
        [267] = ARMV8_L1_ENTRY_INVALID,
        [268] = ARMV8_L1_ENTRY_INVALID,
        [269] = ARMV8_L1_ENTRY_INVALID,
        [270] = ARMV8_L1_ENTRY_INVALID,
        [271] = ARMV8_L1_ENTRY_INVALID,
        [272] = ARMV8_L1_ENTRY_INVALID,
        [273] = ARMV8_L1_ENTRY_INVALID,
        [274] = ARMV8_L1_ENTRY_INVALID,
        [275] = ARMV8_L1_ENTRY_INVALID,
        [276] = ARMV8_L1_ENTRY_INVALID,
        [277] = ARMV8_L1_ENTRY_INVALID,
        [278] = ARMV8_L1_ENTRY_INVALID,
        [279] = ARMV8_L1_ENTRY_INVALID,
        [280] = ARMV8_L1_ENTRY_INVALID,
        [281] = ARMV8_L1_ENTRY_INVALID,
        [282] = ARMV8_L1_ENTRY_INVALID,
        [283] = ARMV8_L1_ENTRY_INVALID,
        [284] = ARMV8_L1_ENTRY_INVALID,
        [285] = ARMV8_L1_ENTRY_INVALID,
        [286] = ARMV8_L1_ENTRY_INVALID,
        [287] = ARMV8_L1_ENTRY_INVALID,
        [288] = ARMV8_L1_ENTRY_INVALID,
        [289] = ARMV8_L1_ENTRY_INVALID,
        [290] = ARMV8_L1_ENTRY_INVALID,
        [291] = ARMV8_L1_ENTRY_INVALID,
        [292] = ARMV8_L1_ENTRY_INVALID,
        [293] = ARMV8_L1_ENTRY_INVALID,
        [294] = ARMV8_L1_ENTRY_INVALID,
        [295] = ARMV8_L1_ENTRY_INVALID,
        [296] = ARMV8_L1_ENTRY_INVALID,
        [297] = ARMV8_L1_ENTRY_INVALID,
        [298] = ARMV8_L1_ENTRY_INVALID,
        [299] = ARMV8_L1_ENTRY_INVALID,
        [300] = ARMV8_L1_ENTRY_INVALID,
        [301] = ARMV8_L1_ENTRY_INVALID,
        [302] = ARMV8_L1_ENTRY_INVALID,
        [303] = ARMV8_L1_ENTRY_INVALID,
        [304] = ARMV8_L1_ENTRY_INVALID,
        [305] = ARMV8_L1_ENTRY_INVALID,
        [306] = ARMV8_L1_ENTRY_INVALID,
        [307] = ARMV8_L1_ENTRY_INVALID,
        [308] = ARMV8_L1_ENTRY_INVALID,
        [309] = ARMV8_L1_ENTRY_INVALID,
        [310] = ARMV8_L1_ENTRY_INVALID,
        [311] = ARMV8_L1_ENTRY_INVALID,
        [312] = ARMV8_L1_ENTRY_INVALID,
        [313] = ARMV8_L1_ENTRY_INVALID,
        [314] = ARMV8_L1_ENTRY_INVALID,
        [315] = ARMV8_L1_ENTRY_INVALID,
        [316] = ARMV8_L1_ENTRY_INVALID,
        [317] = ARMV8_L1_ENTRY_INVALID,
        [318] = ARMV8_L1_ENTRY_INVALID,
        [319] = ARMV8_L1_ENTRY_INVALID,
        [320] = ARMV8_L1_ENTRY_INVALID,
        [321] = ARMV8_L1_ENTRY_INVALID,
        [322] = ARMV8_L1_ENTRY_INVALID,
        [323] = ARMV8_L1_ENTRY_INVALID,
        [324] = ARMV8_L1_ENTRY_INVALID,
        [325] = ARMV8_L1_ENTRY_INVALID,
        [326] = ARMV8_L1_ENTRY_INVALID,
        [327] = ARMV8_L1_ENTRY_INVALID,
        [328] = ARMV8_L1_ENTRY_INVALID,
        [329] = ARMV8_L1_ENTRY_INVALID,
        [330] = ARMV8_L1_ENTRY_INVALID,
        [331] = ARMV8_L1_ENTRY_INVALID,
        [332] = ARMV8_L1_ENTRY_INVALID,
        [333] = ARMV8_L1_ENTRY_INVALID,
        [334] = ARMV8_L1_ENTRY_INVALID,
        [335] = ARMV8_L1_ENTRY_INVALID,
        [336] = ARMV8_L1_ENTRY_INVALID,
        [337] = ARMV8_L1_ENTRY_INVALID,
        [338] = ARMV8_L1_ENTRY_INVALID,
        [339] = ARMV8_L1_ENTRY_INVALID,
        [340] = ARMV8_L1_ENTRY_INVALID,
        [341] = ARMV8_L1_ENTRY_INVALID,
        [342] = ARMV8_L1_ENTRY_INVALID,
        [343] = ARMV8_L1_ENTRY_INVALID,
        [344] = ARMV8_L1_ENTRY_INVALID,
        [345] = ARMV8_L1_ENTRY_INVALID,
        [346] = ARMV8_L1_ENTRY_INVALID,
        [347] = ARMV8_L1_ENTRY_INVALID,
        [348] = ARMV8_L1_ENTRY_INVALID,
        [349] = ARMV8_L1_ENTRY_INVALID,
        [350] = ARMV8_L1_ENTRY_INVALID,
        [351] = ARMV8_L1_ENTRY_INVALID,
        [352] = ARMV8_L1_ENTRY_INVALID,
        [353] = ARMV8_L1_ENTRY_INVALID,
        [354] = ARMV8_L1_ENTRY_INVALID,
        [355] = ARMV8_L1_ENTRY_INVALID,
        [356] = ARMV8_L1_ENTRY_INVALID,
        [357] = ARMV8_L1_ENTRY_INVALID,
        [358] = ARMV8_L1_ENTRY_INVALID,
        [359] = ARMV8_L1_ENTRY_INVALID,
        [360] = ARMV8_L1_ENTRY_INVALID,
        [361] = ARMV8_L1_ENTRY_INVALID,
        [362] = ARMV8_L1_ENTRY_INVALID,
        [363] = ARMV8_L1_ENTRY_INVALID,
        [364] = ARMV8_L1_ENTRY_INVALID,
        [365] = ARMV8_L1_ENTRY_INVALID,
        [366] = ARMV8_L1_ENTRY_INVALID,
        [367] = ARMV8_L1_ENTRY_INVALID,
        [368] = ARMV8_L1_ENTRY_INVALID,
        [369] = ARMV8_L1_ENTRY_INVALID,
        [370] = ARMV8_L1_ENTRY_INVALID,
        [371] = ARMV8_L1_ENTRY_INVALID,
        [372] = ARMV8_L1_ENTRY_INVALID,
        [373] = ARMV8_L1_ENTRY_INVALID,
        [374] = ARMV8_L1_ENTRY_INVALID,
        [375] = ARMV8_L1_ENTRY_INVALID,
        [376] = ARMV8_L1_ENTRY_INVALID,
        [377] = ARMV8_L1_ENTRY_INVALID,
        [378] = ARMV8_L1_ENTRY_INVALID,
        [379] = ARMV8_L1_ENTRY_INVALID,
        [380] = ARMV8_L1_ENTRY_INVALID,
        [381] = ARMV8_L1_ENTRY_INVALID,
        [382] = ARMV8_L1_ENTRY_INVALID,
        [383] = ARMV8_L1_ENTRY_INVALID,
        [384] = ARMV8_L1_ENTRY_INVALID,
        [385] = ARMV8_L1_ENTRY_INVALID,
        [386] = ARMV8_L1_ENTRY_INVALID,
        [387] = ARMV8_L1_ENTRY_INVALID,
        [388] = ARMV8_L1_ENTRY_INVALID,
        [389] = ARMV8_L1_ENTRY_INVALID,
        [390] = ARMV8_L1_ENTRY_INVALID,
        [391] = ARMV8_L1_ENTRY_INVALID,
        [392] = ARMV8_L1_ENTRY_INVALID,
        [393] = ARMV8_L1_ENTRY_INVALID,
        [394] = ARMV8_L1_ENTRY_INVALID,
        [395] = ARMV8_L1_ENTRY_INVALID,
        [396] = ARMV8_L1_ENTRY_INVALID,
        [397] = ARMV8_L1_ENTRY_INVALID,
        [398] = ARMV8_L1_ENTRY_INVALID,
        [399] = ARMV8_L1_ENTRY_INVALID,
        [400] = ARMV8_L1_ENTRY_INVALID,
        [401] = ARMV8_L1_ENTRY_INVALID,
        [402] = ARMV8_L1_ENTRY_INVALID,
        [403] = ARMV8_L1_ENTRY_INVALID,
        [404] = ARMV8_L1_ENTRY_INVALID,
        [405] = ARMV8_L1_ENTRY_INVALID,
        [406] = ARMV8_L1_ENTRY_INVALID,
        [407] = ARMV8_L1_ENTRY_INVALID,
        [408] = ARMV8_L1_ENTRY_INVALID,
        [409] = ARMV8_L1_ENTRY_INVALID,
        [410] = ARMV8_L1_ENTRY_INVALID,
        [411] = ARMV8_L1_ENTRY_INVALID,
        [412] = ARMV8_L1_ENTRY_INVALID,
        [413] = ARMV8_L1_ENTRY_INVALID,
        [414] = ARMV8_L1_ENTRY_INVALID,
        [415] = ARMV8_L1_ENTRY_INVALID,
        [416] = ARMV8_L1_ENTRY_INVALID,
        [417] = ARMV8_L1_ENTRY_INVALID,
        [418] = ARMV8_L1_ENTRY_INVALID,
        [419] = ARMV8_L1_ENTRY_INVALID,
        [420] = ARMV8_L1_ENTRY_INVALID,
        [421] = ARMV8_L1_ENTRY_INVALID,
        [422] = ARMV8_L1_ENTRY_INVALID,
        [423] = ARMV8_L1_ENTRY_INVALID,
        [424] = ARMV8_L1_ENTRY_INVALID,
        [425] = ARMV8_L1_ENTRY_INVALID,
        [426] = ARMV8_L1_ENTRY_INVALID,
        [427] = ARMV8_L1_ENTRY_INVALID,
        [428] = ARMV8_L1_ENTRY_INVALID,
        [429] = ARMV8_L1_ENTRY_INVALID,
        [430] = ARMV8_L1_ENTRY_INVALID,
        [431] = ARMV8_L1_ENTRY_INVALID,
        [432] = ARMV8_L1_ENTRY_INVALID,
        [433] = ARMV8_L1_ENTRY_INVALID,
        [434] = ARMV8_L1_ENTRY_INVALID,
        [435] = ARMV8_L1_ENTRY_INVALID,
        [436] = ARMV8_L1_ENTRY_INVALID,
        [437] = ARMV8_L1_ENTRY_INVALID,
        [438] = ARMV8_L1_ENTRY_INVALID,
        [439] = ARMV8_L1_ENTRY_INVALID,
        [440] = ARMV8_L1_ENTRY_INVALID,
        [441] = ARMV8_L1_ENTRY_INVALID,
        [442] = ARMV8_L1_ENTRY_INVALID,
        [443] = ARMV8_L1_ENTRY_INVALID,
        [444] = ARMV8_L1_ENTRY_INVALID,
        [445] = ARMV8_L1_ENTRY_INVALID,
        [446] = ARMV8_L1_ENTRY_INVALID,
        [447] = ARMV8_L1_ENTRY_INVALID,
        [448] = ARMV8_L1_ENTRY_INVALID,
        [449] = ARMV8_L1_ENTRY_INVALID,
        [450] = ARMV8_L1_ENTRY_INVALID,
        [451] = ARMV8_L1_ENTRY_INVALID,
        [452] = ARMV8_L1_ENTRY_INVALID,
        [453] = ARMV8_L1_ENTRY_INVALID,
        [454] = ARMV8_L1_ENTRY_INVALID,
        [455] = ARMV8_L1_ENTRY_INVALID,
        [456] = ARMV8_L1_ENTRY_INVALID,
        [457] = ARMV8_L1_ENTRY_INVALID,
        [458] = ARMV8_L1_ENTRY_INVALID,
        [459] = ARMV8_L1_ENTRY_INVALID,
        [460] = ARMV8_L1_ENTRY_INVALID,
        [461] = ARMV8_L1_ENTRY_INVALID,
        [462] = ARMV8_L1_ENTRY_INVALID,
        [463] = ARMV8_L1_ENTRY_INVALID,
        [464] = ARMV8_L1_ENTRY_INVALID,
        [465] = ARMV8_L1_ENTRY_INVALID,
        [466] = ARMV8_L1_ENTRY_INVALID,
        [467] = ARMV8_L1_ENTRY_INVALID,
        [468] = ARMV8_L1_ENTRY_INVALID,
        [469] = ARMV8_L1_ENTRY_INVALID,
        [470] = ARMV8_L1_ENTRY_INVALID,
        [471] = ARMV8_L1_ENTRY_INVALID,
        [472] = ARMV8_L1_ENTRY_INVALID,
        [473] = ARMV8_L1_ENTRY_INVALID,
        [474] = ARMV8_L1_ENTRY_INVALID,
        [475] = ARMV8_L1_ENTRY_INVALID,
        [476] = ARMV8_L1_ENTRY_INVALID,
        [477] = ARMV8_L1_ENTRY_INVALID,
        [478] = ARMV8_L1_ENTRY_INVALID,
        [479] = ARMV8_L1_ENTRY_INVALID,
        [480] = ARMV8_L1_ENTRY_INVALID,
        [481] = ARMV8_L1_ENTRY_INVALID,
        [482] = ARMV8_L1_ENTRY_INVALID,
        [483] = ARMV8_L1_ENTRY_INVALID,
        [484] = ARMV8_L1_ENTRY_INVALID,
        [485] = ARMV8_L1_ENTRY_INVALID,
        [486] = ARMV8_L1_ENTRY_INVALID,
        [487] = ARMV8_L1_ENTRY_INVALID,
        [488] = ARMV8_L1_ENTRY_INVALID,
        [489] = ARMV8_L1_ENTRY_INVALID,
        [490] = ARMV8_L1_ENTRY_INVALID,
        [491] = ARMV8_L1_ENTRY_INVALID,
        [492] = ARMV8_L1_ENTRY_INVALID,
        [493] = ARMV8_L1_ENTRY_INVALID,
        [494] = ARMV8_L1_ENTRY_INVALID,
        [495] = ARMV8_L1_ENTRY_INVALID,
        [496] = ARMV8_L1_ENTRY_INVALID,
        [497] = ARMV8_L1_ENTRY_INVALID,
        [498] = ARMV8_L1_ENTRY_INVALID,
        [499] = ARMV8_L1_ENTRY_INVALID,
        [500] = ARMV8_L1_ENTRY_INVALID,
        [501] = ARMV8_L1_ENTRY_INVALID,
        [502] = ARMV8_L1_ENTRY_INVALID,
        [503] = ARMV8_L1_ENTRY_INVALID,
        [504] = ARMV8_L1_ENTRY_INVALID,
        [505] = ARMV8_L1_ENTRY_INVALID,
        [506] = ARMV8_L1_ENTRY_INVALID,
        [507] = ARMV8_L1_ENTRY_INVALID,
        [508] = ARMV8_L1_ENTRY_INVALID,
        [509] = ARMV8_L1_ENTRY_INVALID,
        [510] = ARMV8_L1_ENTRY_INVALID,
        [511] = ARMV8_L1_ENTRY_INVALID
}
},

};

extern uint64_t __pagetables_end;
extern uint64_t __pagetables_start;

